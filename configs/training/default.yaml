# Default training configuration

epochs: 500
batch_size: 16
learning_rate: 1.0e-4
gradient_clip_norm: 1.0
warmup_epochs: 5
val_interval: 30

# EMA settings
use_ema: false
ema:
  decay: 0.9999
  update_after_step: 100
  update_every: 10

# Min-SNR loss weighting
use_min_snr: false
min_snr_gamma: 5.0

# Perceptual loss
perceptual_weight: 0.001

# Multi-GPU
use_multi_gpu: false

# Compile fused forward pass (model + loss) for ~10% speedup
compile_fused_forward: true

# Logging and metrics (all logged at val_interval)
# Mode compatibility: [seg] = segmentation only, [cond] = bravo/dual only, [all] = all modes
logging:
  # Training dynamics
  grad_norm: true              # [all] Track gradient norm (catches instability)
  timestep_losses: true        # [all] Loss by diffusion timestep (use this for seg mode)
  regional_losses: true        # [cond] Loss by tumor vs background region
  timestep_region_losses: true # [cond] 2D heatmap: timestep x region (superset of timestep_losses)

  # Validation metrics
  ssim: true                   # [cond] Structural similarity on generated samples
  psnr: true                   # [cond] Peak signal-to-noise ratio
  boundary_sharpness: true     # [cond] Edge quality in tumor regions

  # Visualization
  intermediate_steps: true     # [cond] Save denoising trajectory (t=1000,500,250,100,0)
  worst_batch: true            # [all] Save batch with highest loss each epoch
  num_intermediate_steps: 5    # How many steps to visualize
